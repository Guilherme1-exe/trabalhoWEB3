{% extends 'base.html' %}

{% block content %}

<!-- Carrossel Hero (agora é seu próprio card) -->
<div class="content-section">
  {% if carousel_images %}
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        {% for image in carousel_images %}
          <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ loop.index0 }}" class="{{ 'active' if loop.first }}" aria-current="{{ 'true' if loop.first }}" aria-label="Slide {{ loop.index }}"></button>
        {% endfor %}
      </div>
      <div class="carousel-inner">
        {% for image in carousel_images %}
          <div class="carousel-item {{ 'active' if loop.first }}">
            <img src="{{ url_for('static', filename='uploads/' + image) }}" class="d-block w-100" alt="Foto do Coletivo {{ loop.index }}">
            <div class="carousel-caption d-none d-md-block">
              <h5>Coletivo Cultural Olhar da Perifa</h5>
              <p>Conheça nossos projetos e participe!</p>
              <a class="btn btn-primary btn-lg" href="#ajudar">Quero Ajudar</a>
            </div>
          </div>
        {% endfor %}
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  {% else %}
    <!-- Fallback se não houver imagens -->
    <div class="p-5 bg-light rounded-3"> <!-- bg-light removido pelo style.css, mas mantido por segurança -->
      <div class="container-fluid py-3">
        <h1 class="display-5 fw-bold">Nossa ONG</h1>
        <p class="col-md-8 fs-5"> O Coletivo Cultural Olhar da Perifa nasceu em Junho de 2022 através de um projeto de fotografia para jovens da rede pública de ensino.
          Trabalhamos por uma causa social importante. Conheça nossos projetos e participe!</p>
        <a class="btn btn-primary btn-lg" href="#ajudar">Quero Ajudar</a>
      </div>
    </div>
  {% endif %}
</div>
<!-- Fim do Carrossel -->


<!-- NOVO: Loop de Seções Personalizadas -->
{% for section in custom_sections %}
<section id="{{ section.slug }}" class="content-section">
  <h2>{{ section.title }}</h2>
  
  <div class="row align-items-center g-4 mt-1">
    <!-- Coluna da Imagem (Imagem à Esquerda) -->
    <div class="col-lg-6">
      <img src="{{ url_for('static', filename='uploads/custom/' + section.image_filename) }}" 
           class="img-fluid rounded-3 shadow-sm" 
           alt="Foto da seção {{ section.title }}">
    </div>
    <!-- Coluna do Texto -->
    <div class="col-lg-6">
      <p class="texto-sobre mb-0">{{ section.text_content }}</p>
    </div>
  </div>
</section>
{% endfor %}
<!-- Fim do Loop de Seções Personalizadas -->


<!-- Sobre (NOVO LAYOUT 50/50 e card próprio) -->
<section id="sobre" class="content-section">
  <h2>Sobre a ONG</h2>
  
  <div class="row align-items-center g-4 mt-1"> <!-- mt-1 (era mt-3) -->
    <!-- Coluna da Imagem (AGORA DINÂMICA) -->
    <div class="col-lg-6">
      
      {% if sobre_data.imagem_filename %}
        <!-- Se o admin subiu uma imagem, usa ela -->
        <img src="{{ url_for('static', filename='uploads/' + sobre_data.imagem_filename) }}" 
             class="img-fluid rounded-3 shadow-sm" 
             alt="Foto da equipe Olhar da Perifa">
      {% else %}
        <!-- Senão, usa o placeholder -->
        <img src="https://placehold.co/600x450/8B0099/FFFFFF?text=Foto+da+Equipe" 
             class="img-fluid rounded-3 shadow-sm" 
             alt="Foto da equipe Olhar da Perifa"
             title="O cliente poderá trocar esta foto em breve">
      {% endif %}
      
    </div>
    <!-- Coluna do Texto -->
    <div class="col-lg-6">
      <p class="texto-sobre mb-0">{{ sobre_data.texto }}</p>
    </div>
  </div>
</section>

<!-- Projetos (AGORA DINÂMICO e card próprio) -->
<section id="projetos" class="content-section">
  <h2>Projetos</h2>
  
  <div class="row row-cols-1 row-cols-md-3 g-4 mt-1"> <!-- mt-1 (era g-4) -->
    {% if projetos %}
      {% for projeto in projetos %}
        <div class="col">
          <!-- O "Card de Projeto" com a classe para o hover -->
          <div class="projeto-card">
            <!-- Imagem de fundo -->
            <img src="{{ url_for('static', filename='uploads/projetos/' + projeto.imagem_filename) }}" alt="{{ projeto.titulo }}" class="projeto-imagem">
            <!-- Overlay com a descrição (aparece no hover) -->
            <div class="projeto-overlay">
              <h3 class="projeto-titulo">{{ projeto.titulo }}</h3>
              <p class="projeto-descricao">{{ projeto.descricao }}</p>
            </div>
            <!-- Título visível (sem hover) -->
            <h5 class="projeto-titulo-visivel">{{ projeto.titulo }}</h5>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="col-12">
        <p>Nenhum projeto cadastrado no momento. Volte em breve!</p>
      </div>
    {% endif %}
  </div>
</section>
<!-- Fim dos Projetos -->


<!-- Seção "Como Ajudar" (Unificada e card próprio) -->
<section id="ajudar" class="content-section">
  <h2>Como Ajudar</h2>
  
  <!-- 1. Ícones (O que você pediu) -->
  <div class="row text-center mb-5 mt-4">
    
    <!-- Bloco Voluntário (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12.382 5.684A1.5 1.5 0 0 0 10.5 6.382V10.5H6.382a1.5 1.5 0 0 0-1.2 2.382L10.5 18.264V13.5h4.118a1.5 1.5 0 0 0 1.2-2.382L10.5 5.736v-.052z"/>
        <path d="M12 21.5a9.5 9.5 0 1 1 0-19 9.5 9.5 0 0 1 0 19zm0-1.5a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM13.882 12H10.5V8.118a1.5 1.5 0 0 0-2.382-1.2L13.5 12.3z"/>
        <path d="M17.06 9.44a.5.5 0 0 1 .16 1.054l-2.43 1.006a.5.5 0 1 1-.22-.988l2.43-1.006a.5.5 0 0 1 .06-.066zM6.94 14.56a.5.5 0 0 1 .16 1.054l-2.43 1.006a.5.5 0 1 1-.22-.988l2.43-1.006a.5.5 0 0 1 .06-.066z"/>
        <path fill-rule="evenodd" d="M14.618 10.5H18.5a1.5 1.5 0 0 1 1.2 2.382l-5.382 5.382a1.5 1.5 0 0 1-2.382-1.2V13.5H8.118a1.5 1.5 0 0 1-1.2-2.382l5.382-5.382a1.5 1.5 0 0 1 2.382 1.2v3.56zM13.5 13.118V16.5a1.5 1.5 0 0 0 2.382 1.2L10.5 12.3v.052l.064-.064L13.5 13.118z" clip-rule="evenodd"/>
      </svg>
      <h4 class="ajudar-titulo">Seja Voluntário</h4>
      <p>Doe seu tempo e talento em nossas oficinas, eventos e ações sociais.</p>
    </div>
    
    <!-- Bloco Doações (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path fill-rule="evenodd" d="M10.5 4.5a1.5 1.5 0 0 1 3 0h.5a3 3 0 0 1 3 3v.5a1.5 1.5 0 0 1 0 3v.5a3 3 0 0 1-3 3h-.5a1.5 1.5 0 0 1-3 0h-.5a3 3 0 0 1-3-3v-.5a1.5 1.5 0 1 1 0-3v-.5a3 3 0 0 1 3-3h.5zm.5 4.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0z" clip-rule="evenodd"/>
        <path d="M12 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm1.5-1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm0 3a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
        <path d="M12 1.5a10.5 10.5 0 1 1 0 21 10.5 10.5 0 0 1 0-21zm0 1.5a9 9 0 1 0 0 18 9 9 0 0 0 0-18z"/>
      </svg>
      <h4 class="ajudar-titulo">Faça uma Doação</h4>
      <p>Sua contribuição financia materiais, lanches e transporte para os alunos.</p>
    </div>
    
    <!-- Bloco Parceria (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M13.623 11.614l.447-.447a2.25 2.25 0 0 1 3.182 0l2.235 2.235a2.25 2.25 0 0 1 0 3.182l-.447.447-3.182-3.182.765-.765z"/>
        <path d="M10.377 12.386l-.447.447a2.25 2.25 0 0 1-3.182 0L4.513 10.6a2.25 2.25 0 0 1 0-3.182l.447-.447 3.182 3.182-.765.765z"/>
        <path d="M8.868 15.632l-3.182-3.182.447-.447a2.25 2.25 0 0 1 3.182 0l2.235 2.235a2.25 2.25 0 0 1 0 3.182l-.447.447z"/>
        <path d="M15.132 8.368l3.182 3.182-.447.447a2.25 2.25 0 0 1-3.182 0L12.45 9.762a2.25 2.25 0 0 1 0-3.182l.447-.447z"/>
        <path d="M11.25 10.75a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
      </svg>
      <h4 class="ajudar-titulo">Seja um Parceiro</h4>
      <p>Sua empresa pode patrocinar projetos, doar equipamentos ou apoiar eventos.</p>
    </div>
  </div>
  
  <!-- 2. Formulário (Integrado) -->
  <div class="row justify-content-center">
    <div class="col-lg-10">
      
      <h3 class="text-center mb-4 mt-3" style="font-family: var(--fonte-titulo); color: var(--cor-roxo-ong); font-size: 2.2rem;">Formulário de Interesse</h3>
      
      <form method="post" action="{{ url_for('index') }}">
        <div class="mb-3">
          <label for="nome" class="form-label">Nome *</label>
          <input type="text" class="form-control" id="nome" name="nome" required>
        </div>
    
        <div class="mb-3">
          <label for="email" class="form-label">E-mail *</label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>
    
        <div class="mb-3">
          <label for="tipo" class="form-label">Tipo de interesse *</label>
          <select class="form-select" id="tipo" name="tipo" required>
            <option value="">-- selecione --</option>
            <option value="voluntario">Voluntário</option>
            <option value="doador">Doador</option>
            <option value="parceiro">Parceiro</option>
          </select>
        </div>
    
        <div class="mb-3">
          <label for="mensagem" class="form-label">Mensagem (opcional)</label>
          <textarea class="form-control" id="mensagem" name="mensagem" rows="4"></textarea>
        </div>
    
        <div class="text-center">
          <button type="submit" class="btn btn-success btn-lg px-5">Enviar</button>
        </div>
      </form>
    </div>
  </div>
</section>
<!-- Fim da Seção "Como Ajudar" -->


<!-- NOVO: Seção Galeria "Nossa Galera" -->
{% if gallery_images %}
<section id="galeria" class="content-section">
  <h2>Nossa Galera</h2>
  
  <div class="row row-cols-2 row-cols-md-4 g-3 mt-1">
    {% for image in gallery_images %}
    <div class="col">
      <div class="gallery-card">
        <img src="{{ url_for('static', filename='uploads/gallery/' + image.filename) }}" alt="Foto da galeria Olhar da Perifa">
      </div>
    </div>
    {% endfor %}
  </div>
  
</section>
{% endif %}
<!-- Fim da Seção "Galeria" -->


<!-- Seção "Contatos" (e card próprio) -->
<section id="contatos" class="content-section">
  <h2>Contatos</h2>
  
  <div class="row text-center mb-4 mt-4">
    
    <!-- Bloco Endereço (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12.001 2c-4.411 0-8 3.589-8 8 0 4.41 8 12 8 12s8-7.59 8-12c0-4.411-3.589-8-8-8zm0 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
      </svg>
      <h4 class="ajudar-titulo">Endereço</h4>
      <p>{{ contatos.endereco }}</p>
    </div>
    
    <!-- Bloco E-mail (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M2.5 4.5h19a1.5 1.5 0 0 1 1.5 1.5v12a1.5 1.5 0 0 1-1.5 1.5h-19a1.5 1.5 0 0 1-1.5-1.5v-12a1.5 1.5 0 0 1 1.5-1.5zM3.684 6L12 11.897 20.316 6H3.684zM21 17.65V7.496l-8.435 5.51a.75.75 0 0 1-.806-.002L3 7.493V17.65c0 .083.067.15.15.15h17.7a.15.15 0 0 0 .15-.15z"/>
      </svg>
      <h4 class="ajudar-titulo">E-mail</h4>
      <p>{{ contatos.email }}</p>
    </div>
    
    <!-- Bloco Telefones (ÍCONE NOVO) -->
    <div class="col-md-4 ajudar-bloco">
      <svg class="ajudar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3.5 1.5a1.5 1.5 0 0 1 1.5 1.5v.135c.42.046.83.13 1.226.248a.75.75 0 0 1 .531.7l.63 2.1a.75.75 0 0 1-.225.795l-1.4 1.12a10.45 10.45 0 0 0 4.545 4.545l1.12-1.4a.75.75 0 0 1 .795-.225l2.1.63a.75.75 0 0 1 .7.53c.119.397.203.807.25 1.227h.136a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5c-10.763 0-19.5-8.737-19.5-19.5A1.5 1.5 0 0 1 3.5 1.5zm1.5 1.5a.75.75 0 0 0 0 1.5c8.008 0 14.5 6.492 14.5 14.5a.75.75 0 0 0 1.5 0c0-8.837-7.163-16-16-16z"/>
      </svg>
      <h4 class="ajudar-titulo">Telefones</h4>
      
      <!-- Lógica para exibir múltiplos telefones -->
      {% if contatos.telefones %}
        {% for tel in contatos.telefones.split(',') %}
          <p class="mb-1">{{ tel.strip() }}</p> <!-- .strip() remove espaços extras -->
        {% endfor %}
      {% else %}
        <p>Nenhum telefone cadastrado.</p>
      {% endif %}
    </div>
    
  </div>
</section>
<!-- Fim da Seção "Contatos" -->

{% endblock %}
